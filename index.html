<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>صالون التميز - الحجز الفاخر</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700;800&display=swap" rel="stylesheet">
  <!-- PWA Manifest -->
  <link rel="manifest" href="data:application/manifest+json,{
    \"name\":\"صالون التميز\",
    \"short_name\":\"التميز\",
    \"start_url\":\".\",
    \"display\":\"standalone\",
    \"background_color\":\"#050817\",
    \"theme_color\":\"#00d9ff\",
    \"icons\":[{\"src\":\"https://via.placeholder.com/192\",\"sizes\":\"192x192\",\"type\":\"image/png\"},{\"src\":\"https://via.placeholder.com/512\",\"sizes\":\"512x512\",\"type\":\"image/png\"}]
  }">
  <style>
    :root {
      --primary: #00d9ff;
      --accent: #00bcd4;
      --text: #8afcff;
      --bg-dark: #050817;
      --input-bg: #0a1024;
      --error: #ff1744;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Tajawal',sans-serif; }
    body {
      background: radial-gradient(circle at top,#050817 0%,#01040f 100%);
      color:var(--text);
      min-height:100vh;
      padding:15px;
      padding-bottom:80px;
    }
    .container {
      background:rgba(10,15,40,0.8);
      padding:28px 22px;
      border-radius:22px;
      border:2px solid var(--primary);
      box-shadow:inset 0 0 25px rgba(0,217,255,0.25),0 0 35px rgba(0,217,255,0.25);
      max-width:460px;
      width:100%;
      text-align:center;
      position:relative;
      backdrop-filter:blur(10px);
      margin:20px auto;
    }
    h1 { color:var(--primary); margin-bottom:10px; font-size:1.9rem; font-weight:800; text-shadow:0 0 15px rgba(0,217,255,0.6); }
    .subtitle { color:var(--text); font-size:1rem; margin-bottom:24px; opacity:0.8; }
    label { display:block; margin-bottom:6px; color:var(--accent); font-weight:600; text-align:right; }
    input, select {
      width:100%; padding:14px 16px; border:2px solid var(--primary); border-radius:14px;
      background:var(--input-bg); color:var(--accent); font-size:1rem; transition:all .3s ease; margin-bottom:18px;
    }
    input.valid { border-color:var(--primary); box-shadow:0 0 10px rgba(0,217,255,0.3); }
    input.invalid { border-color:var(--error); box-shadow:0 0 10px rgba(255,23,68,0.3); }
    input::placeholder { color:rgba(0,217,255,0.5); }
    input:focus, select:focus { outline:none; border-color:#00ffff; box-shadow:0 0 20px rgba(0,255,255,0.4); transform:scale(1.02); }
    .error-message { color:var(--error); font-size:0.85rem; margin-top:-12px; margin-bottom:15px; text-align:right; display:none; font-weight:600; }
    .char-counter { color:var(--accent); font-size:0.8rem; text-align:left; margin-top:-15px; margin-bottom:15px; direction:ltr; }
    button[type="submit"], .login-btn, .edit-btn, .confirm-btn, .cancel-btn, .booking-cancel-btn {
      background:linear-gradient(135deg,#00d9ff,#00bcd4);
      color:white; border:none; padding:15px 32px; font-size:1.15rem; font-weight:700;
      border-radius:16px; cursor:pointer; width:100%; transition:all .3s ease;
      box-shadow:0 0 20px rgba(0,217,255,0.3); margin-top:24px;
    }
    button:hover, .login-btn:hover, .edit-btn:hover { transform:scale(1.05); box-shadow:0 0 40px rgba(0,255,255,0.5); }
    button:disabled { opacity:0.6; cursor:not-allowed; transform:none!important; }
    .cancel-btn, .booking-cancel-btn { background:#ff1744; }
    .cancel-btn:hover, .booking-cancel-btn:hover { background:#d50032; }
    .details-card {
      background:rgba(5,10,25,.95); border:1.5px solid var(--primary); border-radius:16px;
      padding:22px; margin-top:18px; display:none; box-shadow:0 0 20px rgba(0,217,255,0.2);
    }
    .success-toast {
      position:fixed; top:50%; left:50%; transform:translate(-50%,-50%) scale(0.8);
      background:linear-gradient(135deg,#00d9ff,#00bcd4); color:white; padding:20px 28px;
      border-radius:18px; box-shadow:0 0 40px rgba(0,255,255,0.5); z-index:10000;
      text-align:center; font-weight:700; font-size:1.1rem; opacity:0; pointer-events:none; transition:all .4s ease;
    }
    .success-toast.show { opacity:1; transform:translate(-50%,-50%) scale(1); }
    .login-screen {
      position:fixed; top:0; left:0; width:100%; height:100%; background:radial-gradient(circle at top,#050817 0%,#01040f 100%);
      display:flex; justify-content:center; align-items:center; z-index:1000;
    }
    .login-container {
      background:rgba(10,15,40,0.9); padding:30px; border-radius:22px; border:2px solid var(--primary);
      box-shadow:inset 0 0 25px rgba(0,217,255,0.25),0 0 35px rgba(0,217,255,0.25);
      max-width:400px; width:90%; text-align:center; backdrop-filter:blur(10px);
    }
    .login-title { font-size:2.5rem; margin-bottom:20px; color:var(--primary); text-shadow:0 0 15px rgba(0,217,255,0.6); font-weight:800; }
    .bottom-nav {
      position:fixed; bottom:15px; left:50%; transform:translateX(-50%); width:92%; max-width:480px;
      background:rgba(5,10,25,0.95); backdrop-filter:blur(20px); border:1px solid rgba(0,217,255,0.3);
      border-radius:30px; display:flex; justify-content:space-around; padding:10px 0; z-index:100;
      box-shadow:0 -5px 30px rgba(0,0,0,0.4),0 0 20px rgba(0,217,255,0.2);
    }
    @media (max-width:480px) { .bottom-nav { width:90%; max-width:400px; } }
    .nav-item {
      display:flex; flex-direction:column; align-items:center; color:var(--text); cursor:pointer;
      transition:all .3s ease; padding:8px 16px; border-radius:12px;
    }
    .nav-item.active { color:var(--primary); background:rgba(0,217,255,0.1); }
    .nav-icon { width:28px; height:28px; filter:drop-shadow(0 0 5px rgba(0,217,255,0.3)); }
    .nav-label { font-size:0.75rem; margin-top:4px; }
    .profile-screen, .bookings-screen {
      position:fixed; top:0; left:0; width:100%; height:100%; background:radial-gradient(circle at top,#050817 0%,#01040f 100%);
      z-index:200; display:none; flex-direction:column; padding:20px; overflow-y:auto; padding-bottom:80px;
    }
    .screen { display:none; width:100%; min-height:calc(100vh - 80px); padding:20px; padding-bottom:0; }
    .screen.active { display:flex; flex-direction:column; align-items:center; justify-content:flex-start; }
    .hidden { display:none!important; }
    .phone-display { direction:ltr; text-align:center; font-weight:700; color:var(--accent); background:rgba(0,188,212,0.1); border:1px solid var(--accent); border-radius:8px; padding:6px 12px; margin:8px 0; }
    .booking-status { color:#22d97a; font-weight:700; background:rgba(34,217,122,0.1); border:1px solid #22d97a; border-radius:8px; padding:8px; margin:10px 0; }
    .active-booking-banner {
      background:rgba(0,217,255,0.1); border:1px solid var(--primary); border-radius:12px; padding:15px; margin-bottom:20px;
      text-align:center; color:var(--primary); font-weight:600; cursor:pointer;
    }
    .confirmation-modal {
      position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7);
      display:none; justify-content:center; align-items:center; z-index:1000;
    }
    .confirmation-content {
      background:rgba(10,15,40,0.95); padding:25px; border-radius:18px; border:2px solid var(--primary);
      box-shadow:0 0 30px rgba(0,217,255,0.4); text-align:center; max-width:350px; width:90%;
    }
    .confirmation-buttons { display:flex; justify-content:space-between; gap:15px; margin-top:20px; }
    .confirm-yes, .confirm-no { flex:1; padding:12px; border:none; border-radius:10px; font-weight:700; cursor:pointer; }
    .confirm-yes { background:linear-gradient(135deg,#22d97a,#00bcd4); color:white; }
    .confirm-no { background:#ff1744; color:white; }
    .logout-btn {
      background:#ff1744; margin-top:20px; padding:12px; border-radius:12px; font-weight:700;
    }
  </style>
</head>
<body>

  <!-- شاشة تسجيل الدخول -->
  <div id="loginScreen" class="login-screen hidden">
    <div class="login-container">
      <h1 class="login-title">تسجيل دخول</h1>
      <form id="loginForm">
        <label for="userName">الاسم الكامل</label>
        <input type="text" id="userName" required placeholder="أدخل اسمك (عربي فقط - 7-50 حرف)">
        <div class="char-counter" id="userNameCounter">0/50</div>
        <div class="error-message" id="userNameError">الاسم يجب أن يكون عربيًا وطوله بين 7-50 حرف</div>

        <label for="userPhone">رقم الهاتف</label>
        <input type="tel" id="userPhone" required placeholder="أدخل رقمك (11 رقم)">
        <div class="char-counter" id="userPhoneCounter">0/11</div>
        <div class="error-message" id="userPhoneError">رقم الهاتف يجب أن يكون 11 رقم</div>

        <button type="submit" class="login-btn">دخول</button>
      </form>
    </div>
  </div>

  <!-- الشاشة الرئيسية -->
  <div id="mainScreen" class="screen">
    <div class="container">
      <h1>صالون التميز</h1>
      <p class="subtitle">تجربة فاخرة بلمسة تقنية</p>

      <div id="detailsCard" class="details-card"></div>

      <form id="bookingForm">
        <label for="name">الاسم الكامل</label>
        <input type="text" id="name" required placeholder="اسمك الكامل">
        <div class="char-counter" id="nameCounter">0/50</div>
        <div class="error-message" id="nameError">الاسم يجب أن يكون عربيًا وطوله بين 7-50 حرف</div>

        <label for="service">نوع الخدمة</label>
        <select id="service" required>
          <option value="">اختر الخدمة</option>
          <option value="قص شعر VIP">قص شعر VIP</option>
          <option value="حلاقة ذقن ملكية">حلاقة ذقن ملكية</option>
          <option value="صبغة فاخرة">صبغة فاخرة</option>
          <option value="عناية بالبشرة">عناية بالبشرة</option>
        </select>

        <label for="day">اختر اليوم</label>
        <select id="day" required></select>

        <label for="hour">اختر الساعة</label>
        <select id="hour" required></select>

        <button type="submit">احجز الآن</button>
      </form>
    </div>
  </div>

  <!-- شاشة الملف الشخصي -->
  <div id="profileScreen" class="screen">
    <div class="container">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
        <h2 style="color:var(--primary);">الملف الشخصي</h2>
      </div>

      <div class="profile-card" style="background:rgba(10,15,40,0.8); padding:25px; border-radius:18px; border:2px solid var(--primary);">
        <div class="profile-info">
          <label>الاسم الكامل</label>
          <p id="profileName" style="font-size:1.2rem; color:var(--text);"></p>

          <label>رقم الهاتف</label>
          <p id="profilePhone" class="phone-display"></p>
        </div>

        <div id="editProfileForm" class="hidden">
          <h3 style="color:var(--accent); margin:20px 0;">تعديل البيانات</h3>
          <input type="text" id="editName" placeholder="الاسم الجديد">
          <div class="char-counter" id="editNameCounter">0/50</div>
          <div class="error-message" id="editNameError"></div>

          <input type="tel" id="editPhone" placeholder="رقم الهاتف الجديد">
          <div class="char-counter" id="editPhoneCounter">0/11</div>
          <div class="error-message" id="editPhoneError"></div>

          <button type="button" class="confirm-btn" id="confirmEdit">حفظ التغييرات</button>
        </div>

        <button class="edit-btn" id="editBtn">تعديل البيانات</button>
        <button class="logout-btn" id="logoutBtn">تسجيل الخروج</button>
      </div>
    </div>
  </div>

  <!-- شاشة الحجوزات -->
  <div id="bookingsScreen" class="screen">
    <div class="container">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
        <h2 style="color:var(--primary);">حجوزاتي</h2>
      </div>

      <div id="activeBookingBanner" class="active-booking-banner hidden">
        لديك حجز نشط - اضغط لعرض التفاصيل
      </div>

      <div id="bookingsList"></div>
      <div id="noBookingsMessage" class="no-bookings hidden" style="text-align:center; color:#888; margin-top:50px;">
        لا توجد حجوزات حالياً
      </div>
    </div>
  </div>

  <!-- شريط التنقل السفلي -->
  <div class="bottom-nav" id="bottomNav">
    <div class="nav-item active" id="navHome">
      <img src="https://cdn-icons-png.flaticon.com/512/25/25694.png" class="nav-icon" alt="الرئيسية">
      <span class="nav-label">الرئيسية</span>
    </div>
    <div class="nav-item" id="navBookings">
      <img src="https://cdn-icons-png.flaticon.com/512/681/681389.png" class="nav-icon" alt="الحجوزات">
      <span class="nav-label">حجوزاتي</span>
    </div>
    <div class="nav-item" id="navProfile">
      <img src="https://cdn-icons-png.flaticon.com/512/64/64572.png" class="nav-icon" alt="الملف">
      <span class="nav-label">الملف</span>
    </div>
  </div>

  <!-- نافذة تأكيد الإلغاء -->
  <div id="confirmationModal" class="confirmation-modal">
    <div class="confirmation-content">
      <h3 style="color:var(--primary);">تأكيد الإلغاء</h3>
      <p style="color:var(--text); margin:20px 0;">هل أنت متأكد من إلغاء الحجز؟</p>
      <div class="confirmation-buttons">
        <button class="confirm-yes" id="confirmYes">نعم</button>
        <button class="confirm-no" id="confirmNo">لا</button>
      </div>
    </div>
  </div>

  <div id="successToast" class="success-toast"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
    import { getDatabase, ref, onValue, set, remove } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyALYto6lJvO0qrne3mL1zz2jBdlgnA4-nA",
      authDomain: "salonbookingsystem-d2296.firebaseapp.com",
      databaseURL: "https://salonbookingsystem-d2296-default-rtdb.firebaseio.com",
      projectId: "salonbookingsystem-d2296",
      storageBucket: "salonbookingsystem-d2296.firebasestorage.app",
      messagingSenderId: "51763851442",
      appId: "1:51763851442:web:3ebd2e1c6d84a24ac119ab"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // العناصر
    const loginScreen = document.getElementById("loginScreen");
    const mainScreen = document.getElementById("mainScreen");
    const profileScreen = document.getElementById("profileScreen");
    const bookingsScreen = document.getElementById("bookingsScreen");
    const bottomNav = document.getElementById("bottomNav");
    const toast = document.getElementById("successToast");
    const details = document.getElementById("detailsCard");
    const activeBookingBanner = document.getElementById("activeBookingBanner");

    // الحقول
    const nameInput = document.getElementById("name");
    const daysSelect = document.getElementById("day");
    const hoursSelect = document.getElementById("hour");
    const userName = document.getElementById("userName");
    const userPhone = document.getElementById("userPhone");

    // بيانات المستخدم
    let currentUser = JSON.parse(localStorage.getItem("currentUser")) || null;
    let myBooking = JSON.parse(localStorage.getItem("myBooking")) || null;
    let bookingToCancel = null;

    // دالة التوست
    function showToast(msg) {
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(() => toast.classList.remove("show"), 3000);
    }

    // التنقل بين الشاشات
    function showScreen(screen) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      screen.classList.add('active');
    }
    function updateNav(id) {
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // الشاشة الرئيسية
    function showMainScreen() {
      loginScreen.classList.add("hidden");
      showScreen(mainScreen);
      updateNav("navHome");
      bottomNav.style.display = "flex";
      nameInput.value = currentUser.name;
      populateDays();
      populateHours();
    }

    // تحميل الصفحة
    window.addEventListener("DOMContentLoaded", () => {
      if (currentUser) {
        showMainScreen();
        showToast(`مرحباً ${currentUser.name}!`);
      } else {
        loginScreen.classList.remove("hidden");
        bottomNav.style.display = "none";
      }
    });

    // تسجيل الدخول
    document.getElementById("loginForm").addEventListener("submit", e => {
      e.preventDefault();
      const name = userName.value.trim();
      const phone = userPhone.value.trim();

      if (!/^[\u0600-\u06FF\s]{7,50}$/.test(name)) return showToast("الاسم غير صالح");
      if (!/^0\d{10}$/.test(phone)) return showToast("رقم الهاتف يجب أن يكون 11 رقم");

      currentUser = { name, phone, userId: Date.now().toString() };
      localStorage.setItem("currentUser", JSON.stringify(currentUser));
      showMainScreen();
      showToast("تم تسجيل الدخول بنجاح");
    });

    // أيام وساعات
    const days = ["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"];
    function populateDays() {
      daysSelect.innerHTML = "<option value=''>اختر اليوم</option>";
      const today = new Date();
      for (let i = 0; i < 7; i++) {
        const d = new Date(); d.setDate(today.getDate() + i);
        const val = d.toISOString().slice(0,10);
        const opt = document.createElement("option");
        opt.value = val;
        opt.textContent = `${days[d.getDay()]} (${d.getDate()}/${d.getMonth()+1})`;
        daysSelect.appendChild(opt);
      }
    }
    function populateHours() {
      hoursSelect.innerHTML = "<option value=''>اختر الساعة</option>";
      for (let h = 9; h <= 21; h++) {
        const opt = document.createElement("option");
        opt.value = `${h}:00`;
        opt.textContent = `${h}:00`;
        hoursSelect.appendChild(opt);
      }
    }

    // Firebase
    const bookingsRef = ref(db, "bookings");
    let currentBookings = {};
    onValue(bookingsRef, snap => {
      currentBookings = snap.val() || {};
      updateHours();
      if (myBooking && !currentBookings[myBooking.slotKey]) {
        showToast("تم إلغاء حجزك بواسطة الصالون");
        localStorage.removeItem("myBooking");
        myBooking = null;
        details.style.display = "none";
        activeBookingBanner.classList.add("hidden");
      }
    });

    function updateHours() {
      const day = daysSelect.value;
      if (!day) return;
      const now = new Date();
      const today = now.toISOString().slice(0,10);
      hoursSelect.querySelectorAll("option").forEach(opt => {
        if (!opt.value) return;
        const key = `${day}_${opt.value}`;
        const hour = parseInt(opt.value);
        const isPast = (day === today && hour <= now.getHours());
        opt.disabled = currentBookings[key] || isPast;
        opt.style.opacity = opt.disabled ? "0.4" : "1";
      });
    }
    daysSelect.addEventListener("change", updateHours);

    // الحجز
    document.getElementById("bookingForm").addEventListener("submit", async e => {
      e.preventDefault();
      const name = nameInput.value.trim();
      const service = document.getElementById("service").value;
      const day = daysSelect.value;
      const hour = hoursSelect.value;
      if (!name || !service || !day || !hour) return showToast("املأ جميع الحقول");

      const slotKey = `${day}_${hour}`;
      if (currentBookings[slotKey]) return showToast("الموعد محجوز");

      const bookingId = Date.now().toString();
      await set(ref(db, `bookings/${slotKey}/${bookingId}`), {
        name, service, phone: currentUser.phone, userId: currentUser.userId, timestamp: new Date().toISOString()
      });

      myBooking = { name, service, day, hour, slotKey, bookingId };
      localStorage.setItem("myBooking", JSON.stringify(myBooking));
      showToast("تم الحجز بنجاح");
      document.getElementById("bookingForm").reset();
      nameInput.value = currentUser.name;
      populateDays(); populateHNours();
    });

    // عرض التفاصيل
    function showDetails(b) {
      const d = new Date(b.day);
      details.innerHTML = `
        <h3>تفاصيل الحجز</h3>
        <p><b>الاسم:</b> ${b.name}</p>
        <div class="phone-display">رقم الهاتف ${currentUser.phone}</div>
        <p><b>الخدمة:</b> ${b.service}</p>
        <p><b>اليوم:</b> ${days[d.getDay()]} (${d.getDate()}/${d.getMonth()+1})</p>
        <p><b>الساعة:</b> ${b.hour}</p>
        <div class="booking-status">موعد قادم</div>
        <button class="cancel-btn" id="cancelBtn">إلغاء الحجز</button>
      `;
      details.style.display = "block";
      document.getElementById("cancelBtn").onclick = () => showCancelConfirmation(b);
    }

    // إلغاء الحجز
    function showCancelConfirmation(booking) {
      bookingToCancel = booking;
      document.getElementById("confirmationModal").style.display = "flex";
    }
    document.getElementById("confirmYes").onclick = async () => {
      if (!bookingToCancel) return;
      await remove(ref(db, `bookings/${bookingToCancel.slotKey}/${bookingToCancel.bookingId}`));
      if (myBooking && myBooking.bookingId === bookingToCancel.bookingId) {
        localStorage.removeItem("myBooking");
        myBooking = null;
        activeBookingBanner.classList.add("hidden");
      }
      showToast("تم إلغاء الحجز");
      document.getElementById("confirmationModal").style.display = "none";
      loadUserBookings();
      updateHours();
    };
    document.getElementById("confirmNo").onclick = () => {
      document.getElementById("confirmationModal").style.display = "none";
    };

    // تحميل الحجوزات
    function loadUserBookings() {
      const list = document.getElementById("bookingsList");
      list.innerHTML = "";
      let hasBookings = false;

      for (const slotKey in currentBookings) {
        for (const id in currentBookings[slotKey]) {
          const b = currentBookings[slotKey][id];
          if (b.userId === currentUser.userId) {
            hasBookings = true;
            const [day, time] = slotKey.split("_");
            const date = new Date(day);
            const item = document.createElement("div");
            item.className = "booking-item";
            item.style = "background:rgba(10,15,40,0.8); padding:20px; border-radius:16px; border:1.5px solid var(--primary); margin-bottom:15px;";
            item.innerHTML = `
              <p><b>الخدمة:</b> ${b.service}</p>
              <p><b>اليوم:</b> ${days[date.getDay()]} (${date.getDate()}/${date.getMonth()+1})</p>
              <p><b>الساعة:</b> ${time}</p>
              ${myBooking && myBooking.bookingId === id ? '<div class="booking-status">موعد قادم</div>' : ''}
              <button class="booking-cancel-btn" data-b='${JSON.stringify({slotKey, bookingId: id})}'>إلغاء</button>
            `;
            item.querySelector(".booking-cancel-btn").onclick = function() {
              const data = JSON.parse(this.getAttribute("data-b"));
              showCancelConfirmation({slotKey: data.slotKey, bookingId: data.bookingId});
            };
            list.appendChild(item);
          }
        }
      }

      document.getElementById("noBookingsMessage").classList.toggle("hidden", hasBookings);
      if (myBooking) {
        activeBookingBanner.classList.remove("hidden");
        activeBookingBanner.onclick = () => showDetails(myBooking);
      }
    }

    // التنقل
    document.getElementById("navHome").onclick = showMainScreen;
    document.getElementById("navProfile").onclick = () => {
      showScreen(profileScreen);
      updateNav("navProfile");
      document.getElementById("profileName").textContent = currentUser.name;
      document.getElementById("profilePhone").textContent = currentUser.phone;
    };
    document.getElementById("navBookings").onclick = () => {
      showScreen(bookingsScreen);
      updateNav("navBookings");
      loadUserBookings();
    };

    // تعديل الملف
    document.getElementById("editBtn").onclick = () => {
      document.getElementById("editName").value = currentUser.name;
      document.getElementById("editPhone").value = currentUser.phone;
      document.getElementById("editProfileForm").classList.remove("hidden");
    };
    document.getElementById("confirmEdit").onclick = () => {
      const newName = document.getElementById("editName").value.trim();
      const newPhone = document.getElementById("editPhone").value.trim();
      if (!/^[\u0600-\u06FF\s]{7,50}$/.test(newName) || !/^0\d{10}$/.test(newPhone)) {
        showToast("البيانات غير صالحة");
        return;
      }
      currentUser.name = newName;
      currentUser.phone = newPhone;
      localStorage.setItem("currentUser", JSON.stringify(currentUser));
      document.getElementById("profileName").textContent = newName;
      document.getElementById("profilePhone").textContent = newPhone;
      nameInput.value = newName;
      document.getElementById("editProfileForm").classList.add("hidden");
      showToast("تم تحديث البيانات");
    };

    // تسجيل الخروج
    document.getElementById("logoutBtn").onclick = () => {
      if (confirm("هل تريد تسجيل الخروج؟")) {
        localStorage.removeItem("currentUser");
        localStorage.removeItem("myBooking");
        location.reload();
      }
    };

  </script>
</body>
</html>
